<ion-header>
  <ion-navbar>

        <ion-toolbar>

                <ion-buttons left>
                        
                                <button *ngIf="authState" detail-none ion-button menuToggle left>
                                        <ion-icon name="menu"></ion-icon>
                                </button>
                       
                </ion-buttons>
               

                

                

                <ion-title text-center *ngIf="authState" (click)="goToProfile()">{{username}}</ion-title>
                
                <ion-buttons right>

                <ion-row align-items-center *ngIf="authState && !loading">

                <ion-col no-padding>
                        <button *ngIf="authState" color="dark" (click)="goToNotifications()" ion-button icon-only>
                                <ion-icon name="notifications"></ion-icon>
                                <ion-badge *ngIf="unreadNotifications > 0" class="animated swing">{{unreadNotifications}}</ion-badge>
                        </button>                    
                </ion-col>
                
                <ion-col no-padding>
                        <button *ngIf="authState && !loading" detail-none icon-right ion-button (click)="showPopover($event)">
                                <ion-icon name="more"></ion-icon>
                        </button>
                </ion-col>

                </ion-row>
                  

                  <button *ngIf="!authState && !loading" ion-button icon-right outline (click)="goToLogin()">
                        Sign in 
                        <ion-icon name="log-in"></ion-icon>
                        </button>
                 

                </ion-buttons>
        </ion-toolbar>
        
  </ion-navbar>
</ion-header>

<ion-content padding>
  

  

    <div *ngIf="loading" class="horizontal div1">
            <div class="vertical">
                <ion-row justify-content-center>
                                <ion-spinner name="crescent"></ion-spinner>
                </ion-row>
                <ion-row>
                        <h4>Loading. Please wait...</h4>
                </ion-row>
                <!-- Loading. Please wait... -->
            </div>
    </div>

  <div *ngIf="!loading" class="main-content">
          <ion-row no-padding justify-content-center>
                  <h1 id="liveTrades">{{trades_count}} live trades</h1>
          </ion-row>
          <ion-row no-padding justify-content-start align-items-center>
                  <ion-col col-8 no-padding> 
                                <ion-searchbar
                                [(ngModel)]="query"
                                [placeholder]="searchPlaceholder"
                                (ionInput)="doSearch($event)"
                                showCancelButton
                                >
                              </ion-searchbar>
                  </ion-col>

                  <ion-col col-2 no-padding>
                          <button ion-button outline id="settingsBtn" (click)="doSearch($event)" icon-only><ion-icon name="search"></ion-icon></button>
                  </ion-col>
                  <ion-col col-2 no-padding>
                          <button ion-button outline id="settingsBtn" (click)="goToFilters()" icon-only><ion-icon name="settings"></ion-icon></button>
                  </ion-col>
          </ion-row>


          
                  <ion-card class="animated fadeInLeft" *ngFor="let trade of trades; let i = index">
                         
                        <!-- <div *ngIf="trade?.trade?.items?.length === 0">
                                <ion-row justify-content-center>
                                        <h3>No results have been found.</h3>
                                </ion-row>
                        </div> -->
                        <div *ngIf="trade?.trade?.items?.length === 2; else elseBlock">
                                <ion-row justify-content-center align-items-center>
                                        <ion-col col-5 *ngFor="let game of trade.trade.items | slice:0:1">
                                                <ion-row justify-content-center>
                                                        <img class="game-photo" src="https://{{game.game.coverPhoto}}" alt="cover">
                                                        <ion-badge>{{game.game?.pickedGames}}</ion-badge>
                                                </ion-row>
                                                <ion-row justify-content-center>
                                                        <p text-wrap class="game-title">{{game.game?.title | titlecase}}</p>
                                                </ion-row>
                                                <ion-row justify-content-center>
                                                        <p text-wrap class="game-platform">{{game.game?.platform | titlecase}}</p>
                                                </ion-row>
                                        </ion-col>

                                        <ion-col col-2>
                                                <ion-row justify-content-center>
                                                        <ion-icon name="swap" id="swapIcon"></ion-icon>
                                                </ion-row>
                                        </ion-col>

                                        <ion-col col-5 *ngFor="let game of trade.trade.items | slice:1">
                                                <ion-row justify-content-center>
                                                        <img class="game-photo" src="https://{{game.game.coverPhoto}}" alt="cover">
                                                        <ion-badge>{{game.game?.pickedGames}}</ion-badge>
                                                </ion-row>
                                                <ion-row justify-content-center>
                                                        <p text-wrap class="game-title">{{game.game?.title | titlecase}}</p>
                                                </ion-row>
                                                <ion-row justify-content-center>
                                                        <p class="game-platform" text-wrap>{{game.game?.platform | titlecase}}</p>
                                                </ion-row>
                                        </ion-col>
                                </ion-row>
                        </div>

                        <ng-template #elseBlock>
                                <ion-row justify-content-center>
                                        <ion-col col-6>
                                        <ion-slides pager>
                                                <ion-slide *ngFor="let game of trade?.trade?.items | gameType:{type:'interested'}">
                                                <ion-row justify-content-center>
                                                                <img class="game-photo" src="https://{{game.game?.coverPhoto}}" alt="">
                                                                <ion-badge>{{game.game?.pickedGames}}</ion-badge>
                                                </ion-row>
                                                <ion-row justify-content-center>
                                                        <p class="game-title" text-wrap>{{game.game?.title | titlecase}}</p>
                                                </ion-row>
                                                <ion-row justify-content-center>
                                                        <p text-wrap class="game-platform">{{game.game?.platform | titlecase}}</p>
                                                </ion-row>
                                                </ion-slide>
                                        </ion-slides>
                                        </ion-col>
                                        <ion-col col-6>
                                        <ion-slides pager>
                                                        <ion-slide *ngFor="let game of trade?.trade?.items | gameType:{type:'offering'}">
                                                        <ion-row justify-content-center>
                                                                        <img class="game-photo" src="https://{{game.game?.coverPhoto}}" alt="">
                                                                        <ion-badge>{{game.game?.pickedGames}}</ion-badge>
                                                        </ion-row>
                                                        <ion-row justify-content-center>
                                                                <p class="game-title" text-wrap>{{game.game?.title | titlecase}}</p>
                                                        </ion-row>
                                                        <ion-row justify-content-center>
                                                                <p text-wrap class="game-platform">{{game.game?.platform | titlecase}}</p>
                                                        </ion-row>
                                                        </ion-slide>
                                        </ion-slides>
                                        </ion-col>
                                </ion-row>
                        </ng-template>


                </ion-card>
                  

          <ion-infinite-scroll #infiniteScroll (ionInfinite)="loadTrades($event)">
                        <ion-infinite-scroll-content></ion-infinite-scroll-content>
           </ion-infinite-scroll>       
  </div>



</ion-content>


<!-- <ion-fab *ngIf="!loading" bottom right #fab>
                <button ion-fab (click)="searchPartners()"><ion-icon name="search"></ion-icon></button>
</ion-fab> -->
