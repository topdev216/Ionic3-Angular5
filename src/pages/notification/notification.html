<!--
  Generated template for the NotificationPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>Notification</ion-title>
  </ion-navbar>

</ion-header>


<ion-content no-padding>

    <div *ngIf="loading" class="horizontal div1">
        <div class="vertical">
            <ion-spinner name="crescent"></ion-spinner>
        </div>
    </div>

  <ion-segment [(ngModel)]="type">
      <ion-segment-button value="social">
        Social
      </ion-segment-button>
      <ion-segment-button value="trading">
        Trading
      </ion-segment-button>
      
  </ion-segment>

  <div [ngSwitch]="type">

 

  <ion-list *ngSwitchCase="'social'" no-lines>

      <ion-item *ngIf="!socialNotifications || socialNotifications.length === 0"> 
          <ion-row justify-content-center>
            No social notifications available yet.
          </ion-row>
        </ion-item>
   
    <ion-item-sliding *ngFor="let notification of socialNotifications" #item>

    
        <ion-item (click)="expand(notification)">
          <ion-avatar item-start>
            <img *ngIf="notification.notification.data.type == 'social' || notification.notification.data.type == 'offering' " src="{{notification.notification.data.photo}}" alt="asd">
            <img *ngIf="notification.notification.data.type == 'trade'" src="http://placehold.it/100" alt="asd">
            <img *ngIf="notification.notification.data.type == 'trade-decleind' || notification.notification.data.type == 'trade-accept'" src="../../assets/imgs/logoTU.png">
          </ion-avatar>

          
          <h2 text-wrap>{{notification.notification.data.body}}</h2>
          <p>{{notification.timestamp | timeAgo}}</p>
          
          <accordion [expandHeight]="notification.expandHeight" [expanded]="notification.expanded">

              <div text-wrap *ngIf="notification.notification.data.type == 'trade' "> 
                <ion-row justify-content-center> <h3>Status: {{notification.tradeStatus}}</h3></ion-row>
                
                  <ion-row justify-content-center align-items-center>
                    
                    <ion-col *ngFor="let game of notification.games | slice:0:1; index as i;">
                      <ion-row *ngIf="i == 0" justify-content-center>
                          <img id="coverPhoto" src="https://{{game.game.coverPhoto}}" alt="cover">
                      </ion-row>
                    </ion-col>

                    <ion-col>
                        <ion-row justify-content-center>
                            <ion-icon id="swap" name="swap"></ion-icon>
                        </ion-row>
                    </ion-col>

                      <ion-col *ngFor="let game of notification.games | slice:1; index as i;">
                          <ion-row justify-content-center>
                              <img id="coverPhoto" src="https://{{game.game.coverPhoto}}" alt="cover">
                          </ion-row>
                        </ion-col>


                  </ion-row>
                  <!-- <ion-row *ngIf="game.type == 'interested'" justify-content-start></ion-row>
                  <ion-row *ngIf="game.type == 'offering'" justify-content-start></ion-row> -->
                
                  <ion-row justify-content-start>
                    <ion-col>
                      <button [disabled]="!notification.buttonCondition" ion-button block icon-start color="secondary" (click)="acceptTrade(notification)">
                          <ion-icon id="iconButton" name='checkmark'></ion-icon>
                          Accept</button>
                    </ion-col>
                    <ion-col>
                      <button [disabled]="!notification.buttonCondition" ion-button block icon-start color="danger" (click)="declineTrade(notification)" >
                          <ion-icon id="iconButton" name='close'></ion-icon>
                          Decline</button>
                    </ion-col>
                  </ion-row>
              </div>

              <div text-wrap *ngIf="notification.notification.data.type == 'social' || notification.notification.data.type == 'offering' ">
                  <ion-row justify-content-center>
                    <button ion-button outline (click)="viewProfile(notification)">View Profile</button>
                </ion-row>
              </div>
          </accordion>
        </ion-item>

        <ion-item-options icon-start side="right">
          <button ion-button color="danger"(click)="delete(notification)">Delete <ion-icon name="trash"></ion-icon></button>
        </ion-item-options>
        </ion-item-sliding>
  </ion-list>

  <ion-list *ngSwitchCase="'trading'" no-lines>

    <ion-item *ngIf="!tradeNotifications || tradeNotifications.length === 0"> 
      <ion-row justify-content-center>
        No trade notifications available yet.
      </ion-row>
    </ion-item>

    <ion-item-sliding *ngFor="let notification of tradeNotifications" #item>

        <ion-item (click)="expand(notification)">
          <ion-avatar item-start>
            <img *ngIf="notification.notification.data.type == 'social' || notification.notification.data.type == 'offering' " src="{{notification.notification.data.photo}}" alt="asd">
            <img *ngIf="notification.notification.data.type == 'trade'" src="https://placehold.it/100" alt="asd">
            <img *ngIf="notification.notification.data.type == 'trade-decleind' || notification.notification.data.type == 'trade-accept'" src="../../assets/imgs/logoTU.png">
          </ion-avatar>

          
          <h2 text-wrap>{{notification.notification.data.body}}</h2>
          <p>{{notification.timestamp | timeAgo}}</p> 
          
          <accordion [expandHeight]="notification.expandHeight" [expanded]="notification.expanded">

              <div text-wrap *ngIf="notification.notification.data.type == 'trade' "> 
                <ion-row justify-content-center> <h3>Status: {{notification.tradeStatus}}</h3></ion-row>
                
                  <ion-row justify-content-center align-items-center>
                    
                    <ion-col *ngFor="let game of notification.games | slice:0:1; index as i;">
                      <ion-row *ngIf="i == 0" justify-content-center>
                          <img id="coverPhoto" src="https://{{game.game.coverPhoto}}" alt="cover">
                      </ion-row>
                    </ion-col>

                    <ion-col>
                        <ion-row justify-content-center>
                            <ion-icon id="swap" name="swap"></ion-icon>
                        </ion-row>
                    </ion-col>

                      <ion-col *ngFor="let game of notification.games | slice:1; index as i;">
                          <ion-row justify-content-center>
                              <img id="coverPhoto" src="https://{{game.game.coverPhoto}}" alt="cover">
                          </ion-row>
                        </ion-col>


                  </ion-row>
                  <!-- <ion-row *ngIf="game.type == 'interested'" justify-content-start></ion-row>
                  <ion-row *ngIf="game.type == 'offering'" justify-content-start></ion-row> -->
                
                  <ion-row justify-content-start>
                    <ion-col>
                      <button [disabled]="!notification.buttonCondition" ion-button block icon-start color="secondary" (click)="acceptTrade(notification)">
                          <ion-icon id="iconButton" name='checkmark'></ion-icon>
                          Accept</button>
                    </ion-col>
                    <ion-col>
                      <button [disabled]="!notification.buttonCondition" ion-button block icon-start color="danger" (click)="declineTrade(notification)" >
                          <ion-icon id="iconButton" name='close'></ion-icon>
                          Decline</button>
                    </ion-col>
                  </ion-row>
              </div>

              <div text-wrap *ngIf="notification.notification.data.type == 'social' || notification.notification.data.type == 'offering' ">
                <ion-row justify-content-center>
                    <button ion-button outline (click)="viewProfile(notification)">View Profile</button>
                </ion-row>
              </div>
          </accordion>
        </ion-item>

        <ion-item-options icon-start side="right">
          <button ion-button color="danger" (click)="delete(notification)">Delete <ion-icon name="trash"></ion-icon></button>
        </ion-item-options>
        </ion-item-sliding>
  </ion-list>

</div>


</ion-content>
